<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barcode Masters - Profile</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="assets/styles.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            width: 100%;
            overflow-x: hidden;
        }

        .profile-container {
            width: 100%;
            max-width: 100%;
            padding: 1rem;
            box-sizing: border-box;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .profile-layout {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            padding: 1rem;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
        }

        .logo-container {
            width: 100%;
            max-width: 200px;
            display: flex;
            justify-content: center;
            padding: 1rem;
            box-sizing: border-box;
        }

        .logo-container img {
            max-width: 100%;
            height: auto;
            object-fit: contain;
        }

        .player-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .avatar-placeholder {
            width: 64px;
            height: 64px;
            background: #666;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }

        .stats-container {
            display: flex;
            gap: 1rem;
            margin-bottom: 0.5rem;
        }

        .stat-box {
            text-align: center;
            padding: 0.5rem 1rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tooltip-box {
            margin: 1rem auto;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            text-align: center;
            max-width: 600px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            width: 90%;
        }

        .navigation-grid {
            display: grid;
            gap: 1rem;
            width: 90%;
            max-width: 1000px;
            padding: 1rem;
            margin: 0 auto;
            grid-template-columns: repeat(4, 1fr);
        }

        .nav-button {
            padding: 1rem;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: inherit;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(128, 128, 128, 0.3);
        }

        .nav-button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            border-color: rgba(128, 128, 128, 0.5);
        }

        .mvp-monster {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 0.5rem;
            margin-top: 0.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .mvp-monster h3 {
            margin: 0;
            font-size: 0.9rem;
            color: #ffd700;
        }

        .mvp-monster p {
            margin: 0.2rem 0;
            font-size: 0.8rem;
        }

        /* Light mode specific styles */
        body:not(.dark-mode) .nav-button {
            background: rgba(200, 200, 200, 0.2);
            border: 1px solid rgba(0, 0, 0, 0.2);
        }

        body:not(.dark-mode) .nav-button:hover {
            background: rgba(200, 200, 200, 0.3);
            border-color: rgba(0, 0, 0, 0.3);
        }

        /* Desktop Specific Styles */
        @media screen and (min-width: 1024px) {
            .navigation-grid {
                grid-template-columns: repeat(4, 1fr);
                grid-template-rows: repeat(3, auto);
                max-width: 800px;
                margin: 2rem auto;
            }

            .nav-button {
                min-width: 150px;
            }

            /* Position logout button in the center of the last row */
            .nav-button:last-child {
                grid-column: 2 / 4;
            }
        }

        /* Tablet styles */
        @media (max-width: 1023px) and (min-width: 769px) {
            .navigation-grid {
                grid-template-columns: repeat(3, 1fr);
                max-width: 700px;
            }
        }

        /* Mobile styles */
        @media (max-width: 768px) {
            .profile-layout {
                flex-direction: column;
                text-align: center;
                padding: 0.5rem;
                gap: 1rem;
            }

            .logo-container {
                padding: 0.5rem;
                margin-top: 2rem;
            }

            .player-info {
                flex-direction: column;
                width: 90%;
                margin: 0 auto;
                padding: 0.75rem;
            }

            .navigation-grid {
                grid-template-columns: repeat(2, 1fr);
                padding: 0.5rem;
                gap: 0.75rem;
                width: 90%;
                margin: 0 auto;
            }

            .nav-button {
                padding: 0.75rem;
                font-size: 0.9rem;
            }

            .tooltip-box {
                width: 90%;
                margin: 1rem auto;
                padding: 0.75rem;
            }

            .stats-container {
                flex-wrap: wrap;
                justify-content: center;
            }

            .mvp-monster {
                width: 100%;
                box-sizing: border-box;
            }
        }

        @media screen and (max-width: 428px) {
            .profile-container {
                padding: 0.5rem;
            }

            .logo-container {
                margin-top: 3rem;
            }

            .navigation-grid {
                width: 95%;
            }

            .nav-button {
                padding: 0.6rem;
                font-size: 0.85rem;
            }

            .player-info {
                width: 95%;
            }
        }
    </style>
</head>
<body>
    <!-- Dark Mode Toggle -->
    <button id="darkModeToggle" class="dark-mode-toggle">üåô</button>

    <div class="profile-container">
        <div class="profile-layout">
            <!-- Logo -->
            <div class="logo-container">
                <img src="assets/images/BarcodeLogo1.PNG" alt="Barcode Masters Logo">
            </div>

            <!-- Player Info -->
            <div class="player-info">
                <div class="avatar-placeholder">
                    üë§
                </div>
                <div class="player-details">
                    <h2 id="userName">Loading...</h2>
                    <div class="stats-container">
                        <div class="stat-box">
                            <div>Wins</div>
                            <strong id="playerWins">0</strong>
                        </div>
                        <div class="stat-box">
                            <div>Losses</div>
                            <strong id="playerLosses">0</strong>
                        </div>
                    </div>
                    <!-- MVP Monster Section -->
                    <div class="mvp-monster">
                        <h3>‚≠ê MVP Monster</h3>
                        <p id="mvpMonsterName">Loading MVP...</p>
                        <p>Wins: <span id="mvpMonsterWins">0</span> | XP: <span id="mvpMonsterXP">0</span></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Tip Tooltip -->
        <div class="tooltip-box" id="gameTip">
            Loading tip...
        </div>

        <!-- Navigation Buttons -->
        <div class="navigation-grid">
            <button class="nav-button" onclick="location.href='dna-extractor.html'">DNA Extractor</button>
            <button class="nav-button" onclick="location.href='monster-collection.html'">Monster Collection</button>
            <button class="nav-button" onclick="location.href='train-monster.html'">Train Monster</button>
            <button class="nav-button" onclick="location.href='pvp-battle.html'">PVP Battle</button>
            <button class="nav-button" onclick="location.href='player-profile.html'">Player Profile</button>
            <button class="nav-button" onclick="location.href='help.html'">Help</button>
            <button class="nav-button" onclick="location.href='monster-index.html'">Monster Index</button>
            <button class="nav-button" onclick="location.href='leaderboard.html'">Leaderboard</button>
            <button class="nav-button" id="logoutButton">Logout</button>
        </div>

        <!-- Error Message -->
        <p id="errorMessage" style="color: red; display: none;"></p>
    </div>

    <!-- Version Number -->
    <footer>
        <p>Version: <span id="versionNumber">1.0.0</span></p>
    </footer>

    <!-- Firebase SDK (Modules) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDoIWAIUt4HC1RcNmdfXozEr0NG65GO63s",
            authDomain: "barcodemasters-b4b9b.firebaseapp.com",
            projectId: "barcodemasters-b4b9b",
            storageBucket: "barcodemasters-b4b9b.firebasestorage.app",
            messagingSenderId: "827677074735",
            appId: "1:827677074735:web:3bace3d02034348bc82dda",
            measurementId: "G-14YTBBLTPZ"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Game tips array
        const gameTips = [
            "Scan codes to find powerful monsters!",
            "We are trying to remove useless tips... but we keep adding more.",
            "Fetching monsters... please wait.",
            "The Global Monster Index shows all monsters created by players worldwide.",
            "Train your monsters daily to increase their strength.",
            "Different barcodes can yield different monster types.",
            "Challenge other players to climb the rankings!",
            "Combine DNA from different monsters to create new species!(Coming Soon)",
            "Your MVP monster gains bonus in battles!(Coming Soon)",
            "Check your monster collection daily for rewards!",
            "Scan barcodes to collect powerful items and unlock new abilities!(Coming Soon)",
            "Use your monster types wisely to overcome and defeat foes.",
            "The more barcodes you scan, the stronger your character becomes.(Maybe?)",
            "Each barcode you scan brings you closer to uncovering the game‚Äôs secrets.",
            "Some barcodes unlock special challenges that reward you with rare items.",
            "Scan bardcodes to extract DNA and create your unique monster team!",
            "Spend scanned DNA to create powerful upgrades and boost your stats!(Coming Soon)",
            "Don‚Äôt forget to manage your energy ‚Äì scanning barcodes consumes it! (Maybe?)",
            "Be careful! Some barcodes may trigger traps or dangerous encounters.",
            "Discover the lore of Barcode Masters as you scan ancient barcodes scattered throughout the world.",
            "Look for hidden codes in the environment to unlock extra content and secrets.",
            "Training your monsters will give you an edge in battles.",
            "In play for keeps mode, you can win your opponents monster, or lose yours!",
            "All-in Mode: Risk it all by playing for keeps, put your monster up for bet and battle for the ultimate prize.",
            "Each barcode has a story ‚Äì scan them all to piece together the mystery!",
            "Some barcodes for powerful boosts and unique abilities!",
            "Your adventure in Barcode Masters is filled with both danger and discovery.",
            "The monsters you create are unique to you ‚Äì no two players will have the same monsters!",
            "Each monster is synthesized from the DNA of the barcodes you scan.",
            "Each monster is unique, it has its own appearence, strengths and weaknesses.",
            "As you progress, your scanning abilities evolve, unlocking new possibilities!",
            "The world of Barcode Masters is full of mysteries waiting to be uncovered with the right scan.",
            "Keep an eye on your scanner‚Äôs cooldown ‚Äì timing is everything!",
            "Warning: Scanning barcodes may cause uncontrollable excitement.",
            "We know you‚Äôre here for the action, but don‚Äôt forget to read these tooltips... they‚Äôre here for your own good!",
            "This game doesn‚Äôt have any microtransactions... yet.",
            "Scan more barcodes...",
            "Your scanner is powered by pure curiosity. And maybe a little magic.",
            "This tooltip was added just for you, because we know you‚Äôll read it.",
            "Not all tooltips are helpful... but they're can be entertaining!",
            "Just when you thought scanning barcodes couldn‚Äôt get more exciting... it does. Probably.",
            "We hope this tooltip helps. If not, blame it on the interns.",
            "If you think these tooltips are too long, just wait until you get the manual!",
            "Tip: Barcodes are actually the secret to life, the universe, and everything. Scan wisely.",
            "Don't worry, this tooltip won't spoil the plot... mostly because we haven't finished writing it.",
            "Did you know? 87% of players ignore tooltips. Don't be one of them!",
            "Just when you thought you were done with tutorials, here we are again.",
            "This tooltip is like the game itself ‚Äì unexpected and full of surprises!",
            "Some say scanning barcodes is the key to greatness... others just say it's fun.",
            "Our developers are working hard to make this game better. We promise. Probably.",
            "Scan the barcode, get the reward. Or maybe a plot twist... we‚Äôll see!",
            "This tooltip is for informational purposes only. No, seriously, we‚Äôre not sure what it means either.",
            "We put this tooltip here for comedic effect... hopefully it worked.",
            "Some barcodes lead to special bosses ‚Äì defeat them for epic rewards!",
            "This game does not waste your time with 2-factor authentication. You‚Äôre welcome.",
            "Warming up the DNA extractor‚Ä¶",
            "Please stand by while we gather all the monster DNA you never asked for.", 
            "Making sure the monsters don‚Äôt break free‚Ä¶ again. This time we promise it won‚Äôt happen.",
            "Updating leaderboard... current leader is ‚ÄòFunny Name 6969,‚Äô who holds the prestigious title of ‚ÄòMost Monsters, Least Wins.‚Äô",
            "Initiating world domination protocol‚Ä¶ just kidding, we‚Äôre only fixing bugs.",
            "Leaderboard update: 'MasterOfDisaster' has been dethroned, but don‚Äôt worry, they still have the title for ‚ÄòBest at Tripping Over Rocks.‚Äô",
            "Preparing your scanner for the next big thing‚Ä¶ if only we knew what that was.",
            "Checking if all monsters are still behaving‚Ä¶ so far, so good. We‚Äôll update you if they start a rebellion.",
            "Leaderboard‚Äôs looking suspiciously quiet‚Ä¶ are we sure ‚ÄòBarcode King‚Äô hasn‚Äôt gone rogue?",
            "Running a background check on 'SneakySam' for possibly being too good at scanning barcodes.",
            "Monster population update: ‚ÄòSpicyBob‚Äô still leading in the ‚ÄòUnnecessary Roars‚Äô category.",
            "Brief pause to upgrade your scanner‚Ä¶ we‚Äôve added a ‚Äòsnarky comment‚Äô filter.",
            "Updating leaderboard stats: ‚ÄòThe Real Winner‚Äô currently holds the title for ‚ÄòMost Time Spent in Menu Screens.‚Äô",
            "Running diagnostics‚Ä¶ making sure ‚ÄòGiant Potato‚Äô isn‚Äôt cheating in the monster battles.",
            "Current leaderboard update: ‚ÄòLOLz123‚Äô is in first place, but has yet to scan a single barcode. Maybe they're just in it for the fun?",
            "Checking to make sure no monsters are hiding in the code‚Ä¶ it‚Äôs a tight squeeze, but we‚Äôre sure they‚Äôre fine.",
            "Leaderboard update: ‚ÄòBarcodeProMax‚Äô seems to be stuck in the ‚ÄòThinking About Scanning‚Äô phase.",
            "Powering up your scanner... hope it can handle all the ‚ÄòAWESOME‚Äô you‚Äôre about to scan.",
            "Background task: Chasing down ‚ÄòSneakyBarcode‚Äô that‚Äôs been running away from your scanner. Don‚Äôt let it get away!",
            "Leaderboard refresh: ‚ÄòWeirdlyLongName‚Äô still holding the record for ‚ÄòMost Unread Tooltips.‚Äô",
            "Performing system update‚Ä¶ we‚Äôre trying to make the game more fun and less ‚Äòloading screen.‚Äô",
            "Eventually we will add more game tips... but for now, just scan barcodes and have fun!",
        ];

        // Placeholder function to get MVP monster (to be connected to Firebase later)
        function updateMVPMonster() {
            // This will be replaced with actual Firebase data later
            document.getElementById('mvpMonsterName').textContent = "Loading MVP data...";
            document.getElementById('mvpMonsterWins').textContent = "0";
            document.getElementById('mvpMonsterXP').textContent = "0";
        }

        // Function to update game tip
        function updateGameTip() {
            const tipElement = document.getElementById('gameTip');
            const randomTip = gameTips[Math.floor(Math.random() * gameTips.length)];
            tipElement.textContent = randomTip;
        }

        // Update tip every 10 seconds
        updateGameTip();
        setInterval(updateGameTip, 10000);

        // Function to show error message
        function showError(message) {
            const errorElement = document.getElementById('errorMessage');
            errorElement.textContent = message;
            errorElement.style.display = 'block';
        }

        // Function to handle logout
        async function handleLogout() {
            try {
                await signOut(auth);
                localStorage.removeItem("loggedInUser");
                window.location.href = 'index.html';
            } catch (error) {
                console.error('Error during sign-out:', error);
                showError('Failed to log out. Please try again.');
            }
        }

        // Handle logout button click
        document.getElementById('logoutButton').addEventListener('click', handleLogout);

        // Firebase Auth state check
        onAuthStateChanged(auth, async (user) => {
    if (user) {
        const db = getFirestore(app);  // Initialize Firestore
        const userRef = doc(db, "users", user.uid);  // Access the user's document in Firestore
        const docSnap = await getDoc(userRef);  // Fetch the document

        if (docSnap.exists()) {
            // Assuming the username is stored in the 'username' field
            document.getElementById("userName").textContent = docSnap.data().username;
        } else {
            // Handle case where the username is not found
            console.log("No such document!");
        }

        updateMVPMonster(); // Update MVP monster data when user is logged in
    } else {
        window.location.href = 'index.html';
    }
});


        // Handle dark mode toggle
        const darkModeToggle = document.getElementById("darkModeToggle");
        const savedTheme = localStorage.getItem("theme");
        
        if (savedTheme === "dark") {
            document.body.classList.add("dark-mode");
        }

        darkModeToggle.addEventListener("click", function() {
            document.body.classList.toggle("dark-mode");
            localStorage.setItem("theme", document.body.classList.contains("dark-mode") ? "dark" : "light");
        });
    </script>
</body>
</html>