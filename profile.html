<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barcode Masters - Profile</title>
    <link rel="stylesheet" href="assets/styles.css">
    <style>
        .profile-layout {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            padding: 1rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo-container img {
            max-width: 200px;
            height: auto;
        }

        .player-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .avatar-placeholder {
            width: 64px;
            height: 64px;
            background: #666;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }

        .stats-container {
            display: flex;
            gap: 1rem;
            margin-bottom: 0.5rem;
        }

        .stat-box {
            text-align: center;
            padding: 0.5rem 1rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tooltip-box {
            margin: 1rem auto;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            text-align: center;
            max-width: 600px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .navigation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            width: 100%;
            padding: 1rem;
        }

        .nav-button {
            padding: 1rem;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: inherit;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(128, 128, 128, 0.3);
        }

        .nav-button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            border-color: rgba(128, 128, 128, 0.5);
        }

        .mvp-monster {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 0.5rem;
            margin-top: 0.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .mvp-monster h3 {
            margin: 0;
            font-size: 0.9rem;
            color: #ffd700;
        }

        .mvp-monster p {
            margin: 0.2rem 0;
            font-size: 0.8rem;
        }

        /* Light mode specific styles */
        body:not(.dark-mode) .nav-button {
            background: rgba(200, 200, 200, 0.2);
            border: 1px solid rgba(0, 0, 0, 0.2);
        }

        body:not(.dark-mode) .nav-button:hover {
            background: rgba(200, 200, 200, 0.3);
            border-color: rgba(0, 0, 0, 0.3);
        }

        @media (max-width: 768px) {
            .profile-layout {
                flex-direction: column;
                text-align: center;
            }

            .player-info {
                flex-direction: column;
            }

            .navigation-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Dark Mode Toggle -->
    <button id="darkModeToggle" class="dark-mode-toggle">üåô</button>

    <div class="profile-container">
        <div class="profile-layout">
            <!-- Logo -->
            <div class="logo-container">
                <img src="assets/images/BarcodeLogo1.PNG" alt="Barcode Masters Logo">
            </div>

            <!-- Player Info -->
            <div class="player-info">
                <div class="avatar-placeholder">
                    üë§
                </div>
                <div class="player-details">
                    <h2 id="userName">Loading...</h2>
                    <div class="stats-container">
                        <div class="stat-box">
                            <div>Wins</div>
                            <strong id="playerWins">0</strong>
                        </div>
                        <div class="stat-box">
                            <div>Losses</div>
                            <strong id="playerLosses">0</strong>
                        </div>
                    </div>
                    <!-- MVP Monster Section -->
                    <div class="mvp-monster">
                        <h3>‚≠ê MVP Monster</h3>
                        <p id="mvpMonsterName">Loading MVP...</p>
                        <p>Wins: <span id="mvpMonsterWins">0</span> | XP: <span id="mvpMonsterXP">0</span></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Tip Tooltip -->
        <div class="tooltip-box" id="gameTip">
            Loading tip...
        </div>

        <!-- Navigation Buttons -->
        <div class="navigation-grid">
            <button class="nav-button" onclick="location.href='dna-extractor.html'">DNA Extractor</button>
            <button class="nav-button" onclick="location.href='monster-collection.html'">Monster Collection</button>
            <button class="nav-button" onclick="location.href='train-monster.html'">Train Monster</button>
            <button class="nav-button" onclick="location.href='pvp-battle.html'">PVP Battle</button>
            <button class="nav-button" onclick="location.href='player-profile.html'">Player Profile</button>
            <button class="nav-button" onclick="location.href='help.html'">Help</button>
            <button class="nav-button" id="logoutButton">Logout</button>
        </div>

        <!-- Error Message -->
        <p id="errorMessage" style="color: red; display: none;"></p>
    </div>

    <!-- Version Number -->
    <footer>
        <p>Version: <span id="versionNumber">1.0.0</span></p>
    </footer>

    <!-- Firebase SDK (Modules) -->
    <script type="module">
        // Previous Firebase imports and config remain the same...
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDoIWAIUt4HC1RcNmdfXozEr0NG65GO63s",
            authDomain: "barcodemasters-b4b9b.firebaseapp.com",
            projectId: "barcodemasters-b4b9b",
            storageBucket: "barcodemasters-b4b9b.firebasestorage.app",
            messagingSenderId: "827677074735",
            appId: "1:827677074735:web:3bace3d02034348bc82dda",
            measurementId: "G-14YTBBLTPZ"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Game tips array
        const gameTips = [
            "Scan rare items to find powerful monsters!",
            "Train your monsters daily to increase their strength.",
            "Different barcodes can yield different monster types.",
            "Challenge other players to climb the rankings!",
            "Combine DNA from different monsters to create new species!",
            "Your MVP monster gains bonus XP in battles!",
            "Check your monster collection daily for rewards!"
        ];

        // Placeholder function to get MVP monster (to be connected to Firebase later)
        function updateMVPMonster() {
            // This will be replaced with actual Firebase data later
            document.getElementById('mvpMonsterName').textContent = "Loading MVP data...";
            document.getElementById('mvpMonsterWins').textContent = "0";
            document.getElementById('mvpMonsterXP').textContent = "0";
        }

        // Function to update game tip
        function updateGameTip() {
            const tipElement = document.getElementById('gameTip');
            const randomTip = gameTips[Math.floor(Math.random() * gameTips.length)];
            tipElement.textContent = randomTip;
        }

        // Update tip every 10 seconds
        updateGameTip();
        setInterval(updateGameTip, 10000);

        // Function to show error message
        function showError(message) {
            const errorElement = document.getElementById('errorMessage');
            errorElement.textContent = message;
            errorElement.style.display = 'block';
        }

        // Function to handle logout
        async function handleLogout() {
            try {
                await signOut(auth);
                localStorage.removeItem("loggedInUser");
                window.location.href = 'index.html';
            } catch (error) {
                console.error('Error during sign-out:', error);
                showError('Failed to log out. Please try again.');
            }
        }

        // Handle logout button click
        document.getElementById('logoutButton').addEventListener('click', handleLogout);

        // Firebase Auth state check
        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById("userName").textContent = user.email;
                updateMVPMonster(); // Update MVP monster data when user is logged in
            } else {
                window.location.href = 'index.html';
            }
        });

        // Handle dark mode toggle
        const darkModeToggle = document.getElementById("darkModeToggle");
        const savedTheme = localStorage.getItem("theme");
        
        if (savedTheme === "dark") {
            document.body.classList.add("dark-mode");
        }

        darkModeToggle.addEventListener("click", function() {
            document.body.classList.toggle("dark-mode");
            localStorage.setItem("theme", document.body.classList.contains("dark-mode") ? "dark" : "light");
        });
    </script>
</body>
</html>