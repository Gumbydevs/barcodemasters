<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barcode Masters - Monster Collection</title>
    <link rel="stylesheet" href="assets/styles.css">
    <style>
        /* Previous styles remain the same until monster-image-placeholder */
        .monster-image-placeholder {
            width: calc(100% - 2rem); /* Changed to account for padding */
            height: 180px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 1rem;
        }

        /* Add new styles for action buttons */
        .monster-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            padding-top: 0.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .action-button {
            flex: 1;
            padding: 0.5rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.875rem;
            transition: background-color 0.3s ease;
        }

        .rename-button {
            background: #2196F3;
            color: white;
        }

        .rename-button:hover {
            background: #1976D2;
        }

        .delete-button {
            background: #f44336;
            color: white;
        }

        .delete-button:hover {
            background: #d32f2f;
        }

        /* Rest of the previous styles remain the same */
    </style>
</head>
<body>
    <!-- Previous HTML remains the same until the createMonsterCard function -->
    <script type="module">
        // Previous imports and config remain the same

        // Update the createMonsterCard function
        function createMonsterCard(monster) {
            const xpToNextLevel = monster.level * 100;
            const xpProgress = (monster.experience / xpToNextLevel) * 100;
            
            return `
                <div class="monster-card" data-id="${monster.hash}">
                    <div class="monster-image-placeholder">
                        ${monster.type} - Level ${monster.level}
                    </div>
                    <div class="monster-info">
                        <div class="monster-name">${monster.monsterName}</div>
                        <span class="monster-type-badge">${monster.type}</span>
                        <div class="monster-stats">
                            <div class="stat-item">
                                <span>Level</span>
                                <span>${monster.level}</span>
                            </div>
                            <div class="stat-item">
                                <span>XP</span>
                                <span>${monster.experience}/${xpToNextLevel}</span>
                            </div>
                            <div class="stat-item">
                                <span>HP</span>
                                <span>${monster.HP}</span>
                            </div>
                            <div class="stat-item">
                                <span>AP</span>
                                <span>${monster.AP}</span>
                            </div>
                            <div class="stat-item">
                                <span>Speed</span>
                                <span>${monster.Speed}</span>
                            </div>
                            <div class="stat-item">
                                <span>Created</span>
                                <span>${formatDate(monster.dateCreated)}</span>
                            </div>
                        </div>
                        <div class="xp-progress">
                            <div class="xp-progress-bar" style="width: ${xpProgress}%"></div>
                        </div>
                        <div class="monster-actions">
                            <button class="action-button rename-button" onclick="handleRename('${monster.hash}', '${monster.monsterName}')">Rename</button>
                            <button class="action-button delete-button" onclick="handleDelete('${monster.hash}', '${monster.monsterName}')">Delete</button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Add new functions for handling rename and delete
        window.handleRename = async function(monsterId, currentName) {
            if (!confirm(`Are you sure you want to rename this monster? This action cannot be undone.`)) {
                return;
            }

            const newName = prompt("Enter new name for the monster:", currentName);
            if (!newName || newName.trim() === "") return;

            try {
                const user = auth.currentUser;
                const monsterRef = doc(db, `users/${user.uid}/monsters`, monsterId);
                await updateDoc(monsterRef, {
                    monsterName: newName.trim()
                });
                await fetchMonsters(); // Refresh the display
            } catch (error) {
                console.error("Error renaming monster:", error);
                showError("Failed to rename monster. Please try again.");
            }
        };

        window.handleDelete = async function(monsterId, monsterName) {
            if (!confirm(`Are you sure you want to delete ${monsterName}? This action cannot be undone.`)) {
                return;
            }

            try {
                const user = auth.currentUser;
                const monsterRef = doc(db, `users/${user.uid}/monsters`, monsterId);
                await deleteDoc(monsterRef);
                await fetchMonsters(); // Refresh the display
            } catch (error) {
                console.error("Error deleting monster:", error);
                showError("Failed to delete monster. Please try again.");
            }
        };

        // Rest of the previous JavaScript code remains the same
    </script>
</body>
</html>